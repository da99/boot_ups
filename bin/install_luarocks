#!/usr/bin/env bash
# -*- bash -*-
#
#!/usr/bin/env node
# -*- js   -*-
#
#!/usr/bin/env lua
#
#
set -u -e -o pipefail

if [[ -z "$(command -v unzip)" ]]
then
  sudo apt-get install unzip
fi

apps="$(pwd)"
target="$apps/luajit"

cd /tmp
rm -f luarocks-*.tar.gz
base="luarocks-2.1.0"
wget http://luarocks.org/releases/$base.tar.gz

tar xzvf $base.tar.gz
cd $base
./configure                      \
  --prefix=$target               \
  --rocks-tree=.rocks            \
  --with-lua=$target             \
  --with-lua-include=$target/include/luajit-2.0/        \
  --force-config

make build
make install
